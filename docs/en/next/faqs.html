<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Frequently Asked Questions · esy</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;This is a running list of frequently asked questions (recommendations are very welcome)&lt;/p&gt;
"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Frequently Asked Questions · esy"/><meta property="og:type" content="website"/><meta property="og:url" content="https://esy.github.io/index.html"/><meta property="og:description" content="&lt;p&gt;This is a running list of frequently asked questions (recommendations are very welcome)&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/reason-react-red.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://esy.github.io/blog/atom.xml" title="esy Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://esy.github.io/blog/feed.xml" title="esy Blog RSS Feed"/><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/block-white.svg" alt="esy"/><h2 class="headerTitleWithLogo">esy</h2></a><a href="/en/versions.html"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/en/next/getting-started.html" target="_self">Getting started</a></li><li class="siteNavGroupActive"><a href="/docs/en/next/what-why.html" target="_self">Docs</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class="siteNavGroupActive"><a href="/docs/en/next/community.html" target="_self">Community</a></li><li class=""><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/esy/esy" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Reference</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Workflow</h3><ul><li class="navListItem"><a class="navItem" href="/docs/en/next/what-why.html">What &amp; Why</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/getting-started.html">Getting started</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/using-repo-sources-workflow.html">Using Unreleased Packages</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/linking-workflow.html">Linking Packages in Development</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul><li class="navListItem"><a class="navItem" href="/docs/en/next/concepts.html">Concepts</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/configuration.html">Project Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/environment.html">Environment</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/commands.html">Commands</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/low-level-commands.html">Low Level Commands</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/esy-configuration.html">Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/node-compatibility.html">Node/npm Compatibility</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/en/next/faqs.html">Frequently Asked Questions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Community</h3><ul><li class="navListItem"><a class="navItem" href="/docs/en/next/community.html">Community</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Workflow</h3><ul><li class="navListItem"><a class="navItem" href="/docs/en/next/multiple-sandboxes.html">Multiple Project Sandboxes</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/npm-release.html">Building npm Releases</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/opam-workflow.html">Workflow for opam Packages</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/c-workflow.html">Workflow for C/C++ Packages</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/offline.html">Offline Builds</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Internals</h3><ul><li class="navListItem"><a class="navItem" href="/docs/en/next/how-it-works.html">How esy works</a></li><li class="navListItem"><a class="navItem" href="/docs/en/next/development.html">Development</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/esy/esy/tree/master/docs/faqs.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Frequently Asked Questions</h1></header><article><div><span><p>This is a running list of frequently asked questions (recommendations are very welcome)</p>
<h2><a class="anchor" aria-hidden="true" id="dynamic-linking-issues-with-npm-release-library-not-loaded-opt-homebrew-esy-openssl-93ba2454-lib-libssl11dylib"></a><a href="#dynamic-linking-issues-with-npm-release-library-not-loaded-opt-homebrew-esy-openssl-93ba2454-lib-libssl11dylib" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dynamic linking issues with npm release: &quot;Library not loaded /opt/homebrew/.../esy_openssl-93ba2454/lib/libssl.1.1.dylib&quot;</h2>
<p>TLDR; Ensure that required package, in this case <code>esy-openssl</code>, in present in <code>esy.release.includePackages</code> property of <code>esy.json</code>/<code>package.json</code></p>
<p>Binaries often rely on dynamic libraries (esp. on MacOS). HTTP servers relying on popular frameworks to implement https would often rely on openssl, which is often dynamically linked on MacOS (Linux too by default). These need to be present in the sandbox when the binary runs (example, the HTTP server). This happens easily when one runs <code>esy x my-http-server.exe</code>. But, when packaged as an npm package, <code>esy-openssl</code> must be present in the binary's environment. <code>esy</code> already ensures present during <code>esy x ...</code> is also present in binaries exported as NPM package. But it doesn't, by default, export all the packages - they have to be opted in as and when needed. To ensure such dynamically linked library packages are included in the environment of the exported NPM packages, use <code>includePackages</code> property (as explained <a href="https://esy.sh/docs/en/npm-release.html#including-dependencies">here</a>)</p>
<pre><code class="hljs css language-diff">      "includePackages": [
        "root",
        "esy-gmp",
<span class="hljs-addition">+       "esy-openssl"</span>
      ],
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="why-doesn-t-esy-support-dune-operations-like-opam-file-generation-or-copying-of-js-files-in-the-source-tree"></a><a href="#why-doesn-t-esy-support-dune-operations-like-opam-file-generation-or-copying-of-js-files-in-the-source-tree" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why doesn't Esy support Dune operations like opam file generation or copying of JS files in the source tree?</h2>
<p>TLDR; If you're looking to generate opam files with Dune, use <code>esy dune build &lt;project opam file&gt;</code>. For substitution, use <code>esy dune substs</code>.</p>
<p>Any build operation is recommended to be run in an isolated sandboxed environment where the sources are considered
immutable. Esy uses sandbox-exec on MacOS to enforce a sandbox (Linux and Windows are pending). It is always recommended
that build commands are run with <code>esy b ...</code> prefix. For this to work, esy assumes that there is no inplace editing of the
source tree - any in-place editing of sources that take place in the isolated phase makes it hard for esy to bet on immutability
and hence it is not written to handle it well at the moment (hence the cryptic error messages)</p>
<p>Any command that does not generate build artifacts (dune subst, launching lightweight editors etc) are recommended to be run with
just <code>esy ...</code> prefix (We call it the <a href="https://esy.sh/docs/en/environment.html#command-environment">command environment</a> to distinguish it from <a href="https://esy.sh/docs/en/environment.html#build-environment">build environment</a>)</p>
<p>Esy prefers immutability of sources and built artifacts so that it can provide reproducibility guarantees and other benefits immutability brings.</p>
<h2><a class="anchor" aria-hidden="true" id="how-to-generate-opam-file-with-dune"></a><a href="#how-to-generate-opam-file-with-dune" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to generate opam file with Dune?</h2>
<p><code>esy dune build hello-reason.opam</code></p>
<p>It seems there is no way to generate opam files only in the build directory.
<a href="https://discord.com/channels/436568060288172042/469167238268715021/718879610804371506">https://discord.com/channels/436568060288172042/469167238268715021/718879610804371506</a></p>
<p>This means dune build hello-reason.opam will not treat the source tree as immutable.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/en/next/node-compatibility.html"><span class="arrow-prev">← </span><span>Node/npm Compatibility</span></a><a class="docs-next button" href="/docs/en/next/community.html"><span>Community</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#dynamic-linking-issues-with-npm-release-library-not-loaded-opt-homebrew-esy-openssl-93ba2454-lib-libssl11dylib">Dynamic linking issues with npm release: &quot;Library not loaded /opt/homebrew/.../esy_openssl-93ba2454/lib/libssl.1.1.dylib&quot;</a></li><li><a href="#why-doesn-t-esy-support-dune-operations-like-opam-file-generation-or-copying-of-js-files-in-the-source-tree">Why doesn't Esy support Dune operations like opam file generation or copying of JS files in the source tree?</a></li><li><a href="#how-to-generate-opam-file-with-dune">How to generate opam file with Dune?</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/block-white.svg" alt="esy" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/getting-started.html">Getting Started</a><a href="/docs/en/configuration.html">Project Configuration</a><a href="/docs/en/commands.html">Commands Reference</a></div><div><h5>Community</h5><a href="https://discord.gg/reasonml">Discord</a><a href="http://stackoverflow.com/questions/tagged/esy">Stack Overflow</a></div></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'a7cfb79b829d08c14bd06ae075f9baac',
                indexName: 'esy',
                inputSelector: '#search_input_react'
              });
            </script></body></html>